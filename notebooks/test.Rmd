---
---
title: "R Notebook"
output: html_notebook
---

```{r}

library(ggplot2)
library(lubridate)

```

```{r}

startlists_favorites <- list.files("../data/processed/startlists_favorites/", full.names = T) %>% map_df(~read.csv(.x))
startlists_favorites

```


```{r}

startlists_favorites %>%
  filter(year(event_date) == 2025 & rank > 0) %>% 
  ggplot(aes(x = rank, y = combined_score, colour = factor(tier))) +
  geom_point() +
  ggrepel::geom_text_repel(aes(label = rider_name), size = 3) +
  facet_wrap(~event_id)

```


```{r}

startlists_favorites %>% 
  # filter(year(event_date) == 2025 & event_id == "vuelta-a-espana") %>%
  left_join(df_favs %>% select(event_id, event_date, rider_id, tier)) %>%
  ggplot(aes(x = pcs_points_season, y = pcs_points_last_60d, colour = factor(tier))) +
  geom_point(alpha = 0.6) +
  scale_x_sqrt() +
  # scale_y_sqrt() +
  ggrepel::geom_text_repel(aes(label = rider_name), size = 2.5) +
  facet_grid(year(event_date)~event_id)

```

```{r}

results_test <- map_df(list.files("../data/processed/results", full.names = T), ~read.csv(.x, encoding = "UTF-8"))
results_test

results_test %>% 
  mutate(stage_nr = as.numeric(gsub(".*stage-", "", stage_id))) %>% 
  arrange(stage_nr) %>% 
  group_by(event_id, year, stage_nr, category) %>% 
  summarise(count = n()) %>% 
  ggplot(aes(x = stage_nr, y = factor(category, levels = rev(c("stage", "gc", "points", "kom", "youth"))), fill = count)) +
  geom_tile() +
  scale_fill_viridis_c() +
  facet_grid(year~event_id) +
  labs(x = "stage", y = NULL)

```

```{r}

# install.packages(c("blastula", "keyring", "glue"))
library(blastula)
library(keyring)
library(glue)

```

```{r}

create_smtp_creds_key(
  id    = "hotmail",                 # zelf te kiezen naam
  user  = "thomas.014@hotmail.com",  # jouw afzenderadres
  host  = "smtp.hotmail.com",
  port  = 465,                     # SSL-poort
  use_ssl = TRUE
)
# Je krijgt een prompt om het (app-)wachtwoord veilig op te slaan.


```



